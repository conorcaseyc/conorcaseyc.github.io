<!DOCTYPE html>
<html lang="en-US">
  <head>
    <!-- Back end Stuff -->
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <!-- Title -->
    <title>Photopollution Calculator</title>

    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/style.css?v=abf149b770200e2362180eb27a5044ab94b1e6af">
    
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
  
  </head>
  
  <!-- Body -->
  <body>
    <div class="wrapper">
      <!-- Side Bar -->
      <header>
        <!--Logo -->
        <img src="https://github.com/conorcaseyc/conorcaseyc.github.io/raw/master/logo.png" alt="logo" width="35%">

        <!-- Organization -->
        <h1><a href="https://conorcaseyc.github.io">Photopollution Calculator</a></h1>

        <p>The Photopollution Calculator was developed on the results from the BT Young Scientist project called "Is It Possible to Create a Mathematical Model to Predict Photopollution Based on Population Density in Munster?". It will calculate the photopollution of an area in the British Isles and grade that photopollution value.</p>

        <p class="view"><a href="https://github.com/conorcaseyc/Photopollution-Calculator">Visit the Project on GitHub <small>conorcaseyc/Photpollution-Calculator</small></a></p>

        <!-- Tab on Left -->
        <ul>
          <li><a href="#Weather">Get <strong>Weather</strong></a></li>
          <li><a href="#Cal">Access <strong>Calculator</strong></a></li>
          <li><a href="#Twitter">Our <strong>Twitter</strong></a></li>
        </ul>

      </header>

      <!-- Main Website Section -->
      <section>       
        <h1 id='Cal'>Calculator</h1>
        
        <p>
          Is the name of the town being entered?<br>
         </p>
         <center><button class="button" onclick="townNameEntry()" >Yes</button>
         <button class="button" onclick="populationdensity()" >No</button></center>

         <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
                  
         <p id="output"></p>
         <script>
          </script>          
          <script type="text/javascript">
          function townNameEntry() {
          var townName=prompt("Please enter the name of the town.");
          function townNameCap(townName) {
            townName = townName.toLowerCase().split(' ');
            for (var i = 0; i < townName.length; i++) {
              townName[i] = townName[i].charAt(0).toUpperCase() + townName[i].slice(1);
            }
            return townName.join(' ');
          };
          townName = townNameCap(townName);
          var pdot = null;
          $.ajax({
              'async': false,
              'global': false,
              'url': "https://raw.githubusercontent.com/conorcaseyc/Photopollution-Calculator/master/Data/Population_Density/data.json",
              'dataType': "json",
              'success': function (data) {
                  pdot = data;
              }
          });
          function getTownName(name) {
            return pdot.filter(
              function(pdot) {
                return pdot.Towns == name
              }
            );
          }
          var found = getTownName(townName);
          var pd = found[0].PD;
          var sqm = -2.51632097e-03 * pd + 2.07271443e+01;
          sqm = sqm.toFixed(2)
          var stargazing=calculate(sqm);
          function calculate(x) {
            if (x < 17) {
              return "Terrible";
            } else if (x < 18) {
              return "Poor";
            } else if (x < 19) {
              return "Fair";
            } else if (x < 20) {
              return "Good";
            } else if (x < 21) {
              return "Great";
            } else {
              return "Excellent"; 
            }
          }
          var result;
          result="The population density in "+townName+", is "+pd+" people per square kilometre. The photopollution in this area is, therefore, approximately, "+sqm+" mags / arcsec^2. This should correlate to "+stargazing+" Stargazing Conditions.";
          document.getElementById("output").innerHTML = result;
          }

          function populationdensity() {
          var pd=prompt("Please enter the population density of the area you are currently in:");
          var sqm= -2.51632097e-03 * pd + 2.07271443e+01;
          sqm=sqm.toFixed(2);
          var stargazing=calculate(sqm);
          function calculate(x) {
            if (x < 17) {
              return "Terrible";
            } else if (x < 18) {
              return "Poor";
            } else if (x < 19) {
              return "Fair";
            } else if (x < 20) {
              return "Good";
            } else if (x < 21) {
              return "Great";
            } else {
              return "Excellent"; 
            }
          }
          var result;
          result="Photopollution in this area is, approximately, "+sqm+" mags / arcsec^2. This should correlate to "+stargazing+" Stargazing Conditions.";
          document.getElementById("output").innerHTML = result;
          }
          </script>
        
        <h1 id='#Weather'>Weather</h1>
        <script id="weather_output"></script>
        <script>
          function getLocation() {
            if (navigator.geolocation) {
              navigator.geolocation.getCurrentPosition(showPosition);
            } else { 
              document.getElementById("weather_output").innerHTML = "Geolocation is not supported by this browser.";
            }
          }
          
          function showPosition(position) {
            var lat = position.coords.latitude; 
            var long = position.coords.longitude;
            var url = 'https://darksky.net/widget/graph-bar/'+lat+','+long+'/si12/en.js?width=100%&height=400&title=Full Forecast&textColor=333333&bgColor=FFFFFF&transparency=false&skyColor=undefined&fontFamily=Times New Roman&customFont=&units=si&timeColor=333333&tempColor=333333&currentDetailsOption=true';
            console.log(url)
          }
        </script>
        <center><button id="weather_button" class="button" onclick="getLocation()" >Get Weather Information</button></center>
        
        <br>
        <h1 id='Twitter'>Twitter</h1>
        <script type="text/javascript" src="https://feed.mikle.com/js/fw-loader.js" data-fw-param="114736/"></script>
  </body>
</html>
